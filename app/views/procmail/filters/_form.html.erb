<div id="main">
  <% content_for(:site_nav) do %>
    <%= link_to t(:logout), logout_path, :class => :right %>
  <% end %>

  <h1><%= either_of(@filter.new_record?,new(:mail_filter),edit(:mail_filter)) %></h1>


  <%= semantic_form_for [:procmail, @filter], :html =>{:id => :filter} do |f| %>
    <%= f.semantic_errors %>
    <h2 class="left-margin"><%= t(:rule) %></h2>
    <% @filter.rules.each do |rule| %>
      <%= f.inputs :for => [:rules, rule], :class => "inline left-margin compact", :id => :rules do |ref| %>
        <%= render 'rules/form', :f => ref %>
      <% end %>
    <% end %>
    <h2 class="left-margin"><%= t(:action) %></h2>
    <% @filter.actions.each do |action| %>
      <%= f.inputs :for => [:actions, action], :class => "inline left-margin compact", :id => :actions do |ref| %>
        <%= render 'actions/form', :f => ref %>
      <% end %>
    <% end %>
    <div class="flash_plus_button">
      <div id="flash_container">
        <% flash.each do |name, msg| %>
          <%= content_tag :div, msg, :id => "flash_#{name}" %>
        <% end %>
      </div>
      <%= f.submit either_of(@filter.new_record?, t(:create), t(:update)), :class => :right %>
      <%= f.submit t(:cancel), :class => :right, :name => :cancel %>
      <div class="clear"></div>
    </div>
    <div class="clear"></div>
  <% end %>
</div>
